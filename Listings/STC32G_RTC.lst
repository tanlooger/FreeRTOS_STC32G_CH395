C251 COMPILER V5.60.0,  STC32G_RTC                                                         24/03/23  00:55:33  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE STC32G_RTC
OBJECT MODULE PLACED IN .\Objects\STC32G_RTC.obj
COMPILER INVOKED BY: C:\Keil_v5\C251\BIN\C251.EXE Sources\Driver\src\STC32G_RTC.c XSMALL FUNCTIONS(REENTRANT) OPTIMIZE(4
                    -,SPEED) BROWSE INCDIR(.\Sources\User;.\Sources\User\include;.\Sources\FreeRTOS\include;.\Sources\FreeRTOS\portable\STC32
                    -G12K128;.\Sources\Driver\inc;.\Sources\Task\inc;.\Sources\ch395) DEBUG PRINT(.\Listings\STC32G_RTC.lst) TABS(2) OBJECT(.
                    -\Objects\STC32G_RTC.obj) 

stmt  level    source

    1          /*---------------------------------------------------------------------*/
    2          /* --- STC MCU Limited ------------------------------------------------*/
    3          /* --- STC 1T Series MCU Demo Programme -------------------------------*/
    4          /* --- Mobile: (86)13922805190 ----------------------------------------*/
    5          /* --- Fax: 86-0513-55012956,55012947,55012969 ------------------------*/
    6          /* --- Tel: 86-0513-55012928,55012929,55012966 ------------------------*/
    7          /* --- Web: www.STCMCU.com --------------------------------------------*/
    8          /* --- Web: www.STCMCUDATA.com  ---------------------------------------*/
    9          /* --- QQ:  800003751 -------------------------------------------------*/
   10          /* å¦‚æœè¦åœ¨ç¨‹åºä¸­ä½¿ç”¨æ­¤ä»£ç ,è¯·åœ¨ç¨‹åºä¸­æ³¨æ˜ä½¿ç”¨äº†STCçš„èµ„æ–™åŠç¨‹åº            */
   11          /*---------------------------------------------------------------------*/
   12          
   13          #include  "STC32G_RTC.h"
   14          
   15          //========================================================================
   16          // å‡½æ•°: uint8_t  ADC_Inilize(ADC_InitTypeDef *ADCx)
   17          // æè¿°: ADCåˆå§‹åŒ–ç¨‹åº.
   18          // å‚æ•°: ADCx: ç»“æ„å‚æ•°,è¯·å‚è€ƒadc.hé‡Œçš„å®šä¹‰.
   19          // è¿”å›: none.
   20          // ç‰ˆæœ¬: V1.0, 2012-10-22
   21          //========================================================================
   22          uint8_t RTC_Inilize(RTC_InitTypeDef *RTCx)
   23          {
   24   1        if(RTCx->RTC_Year > 99) return FAIL;  //é”™è¯¯
   25   1        if(RTCx->RTC_Month > 12)  return FAIL;  //é”™è¯¯
   26   1        if(RTCx->RTC_Day > 31)  return FAIL;  //é”™è¯¯
   27   1        if(RTCx->RTC_Hour > 23) return FAIL;  //é”™è¯¯
   28   1        if(RTCx->RTC_Min > 59)  return FAIL;  //é”™è¯¯
   29   1        if(RTCx->RTC_Sec > 59)  return FAIL;  //é”™è¯¯
   30   1        if(RTCx->RTC_Ssec > 127)  return FAIL;  //é”™è¯¯
   31   1        if(RTCx->RTC_ALAHour > 23)  return FAIL;  //é”™è¯¯
   32   1        if(RTCx->RTC_ALAMin > 59) return FAIL;  //é”™è¯¯
   33   1        if(RTCx->RTC_ALASec > 59) return FAIL;  //é”™è¯¯
   34   1        if(RTCx->RTC_ALASsec > 127) return FAIL;  //é”™è¯¯
   35   1      
   36   1        INIYEAR = RTCx->RTC_Year;
   37   1        INIMONTH = RTCx->RTC_Month;
   38   1        INIDAY = RTCx->RTC_Day;
   39   1        INIHOUR = RTCx->RTC_Hour;
   40   1        INIMIN = RTCx->RTC_Min;
   41   1        INISEC = RTCx->RTC_Sec;
   42   1        INISSEC = RTCx->RTC_Ssec;
   43   1      
   44   1        ALAHOUR = RTCx->RTC_ALAHour;  //é—¹é’Ÿå°æ—¶
   45   1        ALAMIN  = RTCx->RTC_ALAMin;   //é—¹é’Ÿåˆ†é’Ÿ
   46   1        ALASEC  = RTCx->RTC_ALASec;   //é—¹é’Ÿç§’
   47   1        ALASSEC = RTCx->RTC_ALASsec;  //é—¹é’Ÿ1/128ç§’
   48   1      
   49   1        if(RTCx->RTC_Clock == RTC_IRC32KCR)
   50   1        {
   51   2          //STC32G èŠ¯ç‰‡ä½¿ç”¨å†…éƒ¨32Kæ—¶é’Ÿï¼Œä¼‘çœ æ— æ³•å”¤é†’
   52   2          IRC32KCR = 0x80;   //å¯åŠ¨å†…éƒ¨32Kæ™¶æŒ¯.
   53   2          while (!(IRC32KCR & 1));  //ç­‰å¾…æ—¶é’Ÿç¨³å®š
   54   2          RTCCFG = 0x03;    //é€‰æ‹©å†…éƒ¨32Kæ—¶é’Ÿæºï¼Œè§¦å‘RTCå¯„å­˜å™¨åˆå§‹åŒ–
   55   2        }
   56   1        else
C251 COMPILER V5.60.0,  STC32G_RTC                                                         24/03/23  00:55:33  PAGE 2   

   57   1        {
   58   2          X32KCR = 0x80 + 0x40;   //å¯åŠ¨å¤–éƒ¨32Kæ™¶æŒ¯, ä½å¢ç›Š+0x00, é«˜å¢ç›Š+0x40.
   59   2          while (!(X32KCR & 1));  //ç­‰å¾…æ—¶é’Ÿç¨³å®š
   60   2          RTCCFG = 0x01;    //é€‰æ‹©å¤–éƒ¨32Kæ—¶é’Ÿæºï¼Œè§¦å‘RTCå¯„å­˜å™¨åˆå§‹åŒ–
   61   2        }
   62   1      
   63   1        if(RTCx->RTC_Enable == ENABLE)
   64   1        {
   65   2          RTCCR = 0x01;     //RTCä½¿èƒ½
   66   2          while(RTCCFG & 0x01); //ç­‰å¾…åˆå§‹åŒ–å®Œæˆ,éœ€è¦åœ¨ "RTCä½¿èƒ½" ä¹‹ååˆ¤æ–­. 
   67   2          //è®¾ç½®RTCæ—¶é—´éœ€è¦32768Hzçš„1ä¸ªå‘¨æœŸæ—¶é—´,å¤§çº¦30.5us. ç”±äºåŒæ­¥, æ‰€ä»¥å®é™…ç­‰å¾…æ—¶é—´æ
             -˜¯0~30.5us.
   68   2          //å¦‚æœä¸ç­‰å¾…è®¾ç½®å®Œæˆå°±ç¡çœ , åˆ™RTCä¼šç”±äºè®¾ç½®æ²¡å®Œæˆ, åœæ­¢è®¡æ•°, å”¤é†’åæ‰ç»§ç»
             -­å®Œæˆè®¾ç½®å¹¶ç»§ç»­è®¡æ•°.
   69   2        }
   70   1        else
   71   1        {
   72   2          RTCCR = 0x00;     //RTCå…³é—­
   73   2        }
   74   1        
   75   1        return SUCCESS;
   76   1      }
   77          
   78          


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       426     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =    ------     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
